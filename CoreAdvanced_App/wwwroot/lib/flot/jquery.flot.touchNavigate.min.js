!function(c){"use strict";var v=c.plot.uiConstants.ZOOM_DISTANCE_MARGIN;function t(u,e){var n,i,a,d,p={zoomEnable:!1,prevDistance:null,prevTapTime:0,prevPanPosition:{x:0,y:0},prevTapPosition:{x:0,y:0}},h={prevTouchedAxis:"none",currentTouchedAxis:"none",touchedAxis:null,navigationConstraint:"unconstrained",initialState:null},o=e.pan.interactive&&"manual"===e.pan.touchMode,r="smartLock"===e.pan.touchMode,s=e.pan.interactive&&(r||"smart"===e.pan.touchMode);function l(e){h.touchedAxis=function(e,t,n){{if("pinchstart"!==t.type)return"panstart"===t.type||"pinchend"===t.type?e.getTouchedAxis(t.detail.touches[0].pageX,t.detail.touches[0].pageY):n.touchedAxis;n=e.getTouchedAxis(t.detail.touches[0].pageX,t.detail.touches[0].pageY),t=e.getTouchedAxis(t.detail.touches[1].pageX,t.detail.touches[1].pageY);if(n.length===t.length&&n.toString()===t.toString())return n}}(u,e,h),x(h)?h.navigationConstraint="unconstrained":h.navigationConstraint="axisConstrained"}n={start:function(e){l(e),g(e,"pan",p,h),s&&(e=f(e,"pan"),h.initialState=u.navigationState(e.x,e.y))},drag:function(e){var t;l(e),s?(t=f(e,"pan"),u.smartPan({x:h.initialState.startPageX-t.x,y:h.initialState.startPageY-t.y},h.initialState,h.touchedAxis,!1,r)):o&&(u.pan({left:-P(e,"pan",p).x,top:-P(e,"pan",p).y,axes:h.touchedAxis}),A(e,"pan",p,h))},end:function(e){var t;l(e),s&&u.smartPan.end(),t=e,p.zoomEnable&&1===t.detail.touches.length&&updateprevPanPosition(e,"pan",p,h)}},i={start:function(e){var t;d&&(clearTimeout(d),d=null),l(e),t=e,p.prevDistance=T(t),g(e,"pinch",p,h)},drag:function(c){d=d||setTimeout(function(){l(c),u.pan({left:-P(c,"pinch",p).x,top:-P(c,"pinch",p).y,axes:h.touchedAxis}),A(c,"pinch",p,h);var e,t,n,i,a,o,r,s=T(c);(p.zoomEnable||Math.abs(s-p.prevDistance)>v)&&(t=c,n=p,i=h,a=(e=u).offset(),o={left:0,top:0},r=T(t)/n.prevDistance,s=T(t),o.left=f(t,"pinch").x-a.left,o.top=f(t,"pinch").y-a.top,e.zoom({center:o,amount:r,axes:i.touchedAxis}),n.prevDistance=s,p.zoomEnable=!0),d=null},1e3/60)},end:function(e){d&&(clearTimeout(d),d=null),l(e),p.prevDistance=null}},a={recenterPlot:function(e){var t,n;e&&e.detail&&"touchstart"===e.detail.type&&(function(e,t,n){var i=e.getTouchedAxis(t.detail.firstTouch.x,t.detail.firstTouch.y);void 0!==i[0]&&(n.prevTouchedAxis=i[0].direction);void 0!==(i=e.getTouchedAxis(t.detail.secondTouch.x,t.detail.secondTouch.y))[0]&&(n.touchedAxis=i,n.currentTouchedAxis=i[0].direction);x(n)&&(n.touchedAxis=null,n.prevTouchedAxis="none",n.currentTouchedAxis="none")}(t=u,n=e,e=h),("x"===e.currentTouchedAxis&&"x"===e.prevTouchedAxis||"y"===e.currentTouchedAxis&&"y"===e.prevTouchedAxis||"none"===e.currentTouchedAxis&&"none"===e.prevTouchedAxis)&&(t.recenter({axes:e.touchedAxis}),n=e.touchedAxis?new c.Event("re-center",{detail:{axisTouched:e.touchedAxis}}):new c.Event("re-center",{detail:n}),t.getPlaceholder().trigger(n)))}},!0!==e.pan.enableTouch&&!0!==e.zoom.enableTouch||(u.hooks.bindEvents.push(function(e,t){(e=e.getOptions()).zoom.interactive&&e.zoom.enableTouch&&(t[0].addEventListener("pinchstart",i.start,!1),t[0].addEventListener("pinchdrag",i.drag,!1),t[0].addEventListener("pinchend",i.end,!1)),e.pan.interactive&&e.pan.enableTouch&&(t[0].addEventListener("panstart",n.start,!1),t[0].addEventListener("pandrag",n.drag,!1),t[0].addEventListener("panend",n.end,!1)),e.recenter.interactive&&e.recenter.enableTouch&&t[0].addEventListener("doubletap",a.recenterPlot,!1)}),u.hooks.shutdown.push(function(e,t){t[0].removeEventListener("panstart",n.start),t[0].removeEventListener("pandrag",n.drag),t[0].removeEventListener("panend",n.end),t[0].removeEventListener("pinchstart",i.start),t[0].removeEventListener("pinchdrag",i.drag),t[0].removeEventListener("pinchend",i.end),t[0].removeEventListener("doubletap",a.recenterPlot)}))}function x(e){return!e.touchedAxis||0===e.touchedAxis.length}function g(e,t,n,i){e=f(e,t);switch(i.navigationConstraint){case"unconstrained":i.touchedAxis=null,n.prevTapPosition={x:n.prevPanPosition.x,y:n.prevPanPosition.y},n.prevPanPosition={x:e.x,y:e.y};break;case"axisConstrained":t=i.touchedAxis[0].direction,i.currentTouchedAxis=t,n.prevTapPosition[t]=n.prevPanPosition[t],n.prevPanPosition[t]=e[t]}}function T(e){var t,n=e.detail.touches[0],i=e.detail.touches[1];return t=n.pageX,e=n.pageY,n=i.pageX,i=i.pageY,Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))}function A(e,t,n,i){t=f(e,t);switch(i.navigationConstraint){case"unconstrained":n.prevPanPosition.x=t.x,n.prevPanPosition.y=t.y;break;case"axisConstrained":n.prevPanPosition[i.currentTouchedAxis]=t[i.currentTouchedAxis]}}function P(e,t,n){t=f(e,t);return{x:t.x-n.prevPanPosition.x,y:t.y-n.prevPanPosition.y}}function f(e,t){return"pinch"===t?{x:(e.detail.touches[0].pageX+e.detail.touches[1].pageX)/2,y:(e.detail.touches[0].pageY+e.detail.touches[1].pageY)/2}:{x:e.detail.touches[0].pageX,y:e.detail.touches[0].pageY}}c.plot.plugins.push({init:function(e){e.hooks.processOptions.push(t)},options:{zoom:{enableTouch:!1},pan:{enableTouch:!1,touchMode:"manual"},recenter:{enableTouch:!0}},name:"navigateTouch",version:"0.3"})}(jQuery);